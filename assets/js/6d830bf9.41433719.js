"use strict";(self.webpackChunkdocusaurus_wiki=self.webpackChunkdocusaurus_wiki||[]).push([[50096],{3905:function(e,a,n){n.d(a,{Zo:function(){return u},kt:function(){return k}});var i=n(67294);function t(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);a&&(i=i.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){t(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,i,t=function(e,a){if(null==e)return{};var n,i,t={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var d=i.createContext({}),o=function(e){var a=i.useContext(d),n=a;return e&&(n="function"==typeof e?e(a):l(l({},a),e)),n},u=function(e){var a=o(e.components);return i.createElement(d.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return i.createElement(i.Fragment,{},a)}},g=i.forwardRef((function(e,a){var n=e.components,t=e.mdxType,r=e.originalType,d=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),g=o(n),k=t,c=g["".concat(d,".").concat(k)]||g[k]||p[k]||r;return n?i.createElement(c,l(l({ref:a},u),{},{components:n})):i.createElement(c,l({ref:a},u))}));function k(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var r=n.length,l=new Array(r);l[0]=g;var s={};for(var d in a)hasOwnProperty.call(a,d)&&(s[d]=a[d]);s.originalType=e,s.mdxType="string"==typeof e?e:t,l[1]=s;for(var o=2;o<r;o++)l[o]=n[o];return i.createElement.apply(null,l)}return i.createElement.apply(null,n)}g.displayName="MDXCreateElement"},44075:function(e,a,n){n.r(a),n.d(a,{assets:function(){return u},contentTitle:function(){return d},default:function(){return k},frontMatter:function(){return s},metadata:function(){return o},toc:function(){return p}});var i=n(83117),t=n(80102),r=(n(67294),n(3905)),l=["components"],s={},d=void 0,o={unversionedId:"TimPengembang/Infrastruktur/IrgshV1",id:"TimPengembang/Infrastruktur/IrgshV1",title:"IrgshV1",description:"Masuk sebagai user irgsh",source:"@site/wiki/TimPengembang/Infrastruktur/IrgshV1.md",sourceDirName:"TimPengembang/Infrastruktur",slug:"/TimPengembang/Infrastruktur/IrgshV1",permalink:"/TimPengembang/Infrastruktur/IrgshV1",draft:!1,editUrl:"https://github.com/BlankOn/wiki/edit/master/wiki/TimPengembang/Infrastruktur/IrgshV1.md",tags:[],version:"current",frontMatter:{}},u={},p=[{value:"irgsh-web",id:"irgsh-web",level:2},{value:"web",id:"web",level:3},{value:"taskinit",id:"taskinit",level:3},{value:"irgsh-node",id:"irgsh-node",level:2},{value:"irgsh-repo",id:"irgsh-repo",level:2},{value:"error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system",id:"error140b0002ssl-routinesssl_ctx_use_privatekey_filesystem",level:3},{value:"Unduhan via source type Git macet",id:"unduhan-via-source-type-git-macet",level:3},{value:"Build macet di Waiting for Initialization",id:"build-macet-di-waiting-for-initialization",level:3},{value:"Kode sumber tidak dapat diunduh",id:"kode-sumber-tidak-dapat-diunduh",level:3},{value:"Galat memori&#39;Memory exeption&#39;",id:"galat-memorimemory-exeption",level:3},{value:"X not installed",id:"x-not-installed",level:3},{value:"No suitable builder found",id:"no-suitable-builder-found",level:3},{value:"Build gagal, banyak paket yang 404 di build.log.gz",id:"build-gagal-banyak-paket-yang-404-di-buildloggz",level:3},{value:"Build gagal setelah langkah <code>Uploading package</code> dan tidak ada laporan dari repo.log",id:"build-gagal-setelah-langkah-uploading-package-dan-tidak-ada-laporan-dari-repolog",level:3}],g={toc:p};function k(e){var a=e.components,n=(0,t.Z)(e,l);return(0,r.kt)("wrapper",(0,i.Z)({},g,n,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("img",{src:"https://badgen.net/badge/wiki/kadaluarsa/red?icon=github"}),(0,r.kt)("h1",{id:"menjalankan-irgsh-di-rani-"},"Menjalankan irgsh di ",(0,r.kt)("inlineCode",{parentName:"h1"},"rani")," :"),(0,r.kt)("p",null,"Masuk sebagai user ",(0,r.kt)("inlineCode",{parentName:"p"},"irgsh")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"$ sudo -u irgsh -i\n")),(0,r.kt)("p",null,"pindah direktori kerja ke direktori web irgsh"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"irgsh$ cd v2/web-interfaces\n")),(0,r.kt)("p",null,"Jalankan script fastcgi"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"irgsh$ ./run-fastcgi-2.sh\n")),(0,r.kt)("p",null,"Gunakan ",(0,r.kt)("inlineCode",{parentName:"p"},"tmux")," atau ",(0,r.kt)("inlineCode",{parentName:"p"},"screen")," untuk manjalankan skrip taskinit"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"irgsh$ tmux ### atau screen\n")),(0,r.kt)("p",null,"jalankan skrip taskinit"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"irgsh$ ./run-taskinit-2.sh\n")),(0,r.kt)("p",null,"detach dari ",(0,r.kt)("em",{parentName:"p"},"tmux")," atau ",(0,r.kt)("em",{parentName:"p"},"screen")),(0,r.kt)("h1",{id:"menjalankan-irgsh-di-alynne-"},"Menjalankan irgsh di ",(0,r.kt)("inlineCode",{parentName:"h1"},"alynne")," :"),(0,r.kt)("h2",{id:"irgsh-web"},"irgsh-web"),(0,r.kt)("h3",{id:"web"},"web"),(0,r.kt)("p",null,"Masuk sebagai user irgsh, pindah ke ",(0,r.kt)("inlineCode",{parentName:"p"},"/home/irgsh/irgsh-web/"),", lalu :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ python manage.py runfcgi method=prefork host=0.0.0.0 port=8001\n")),(0,r.kt)("h3",{id:"taskinit"},"taskinit"),(0,r.kt)("p",null,"Masuk sebagai user irgsh, pindah ke ",(0,r.kt)("inlineCode",{parentName:"p"},"/home/irgsh/irgsh-web/"),", bikin screen baru, lalu :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ python manage.py celeryd -n taskinit -l DEBUG\n")),(0,r.kt)("h2",{id:"irgsh-node"},"irgsh-node"),(0,r.kt)("p",null,"Masuk sebagai user builder, pindah ke ",(0,r.kt)("inlineCode",{parentName:"p"},"/home/builder/irgsh-node"),", bikin screen baru, lalu :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ ./bin/irgsh-node -l DEBUG\n")),(0,r.kt)("p",null,"Untuk uploader, bikin screen baru, lalu :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ ./bin/irgsh-uploader -l DEBUG\n")),(0,r.kt)("h2",{id:"irgsh-repo"},"irgsh-repo"),(0,r.kt)("p",null,"Masuk sebagai user irgsh-repo, pindah ke ",(0,r.kt)("inlineCode",{parentName:"p"},"/home/irgsh-repo/irgsh-repo"),", bikin screen baru, lalu :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo ./bin/irgsh-repo -l DEBUG\n")),(0,r.kt)("h1",{id:"sidik-gangguan"},"Sidik gangguan"),(0,r.kt)("h3",{id:"error140b0002ssl-routinesssl_ctx_use_privatekey_filesystem"},"error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[2017-08-26 23:39:48,111: ERROR/MainProcess] Consumer: Connection Error: [Errno 336265218] _ssl.c:347: error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system lib. Trying again in 4 seconds...\n")),(0,r.kt)("p",null,"Cek sertifikat dan kunci private milik builder terkait. Berkas sertifikat dan kunci tersebut mesti bisa dibaca oleh user yang menjalankan builder / irgsh-node."),(0,r.kt)("h3",{id:"unduhan-via-source-type-git-macet"},"Unduhan via source type Git macet"),(0,r.kt)("p",null,"Cek ke log taskinit, jawab yes, "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[2017-08-26 23:21:20,448: DEBUG/MainProcess] Mediator: Running callback for task: irgsh_web.build.tasks.UploadSource[c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3]\n[2017-08-26 23:21:20,449: DEBUG/MainProcess] TaskPool: Apply <function execute_and_trace at 0x562655c397d0> (args:('irgsh_web.build.tasks.UploadSource', 'c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3', (9721, [u'aglfn_1.7-3blankon1.dsc', u'aglfn_1.7.orig.tar.gz', u'aglfn_1.7-3blankon1.debian.tar.xz']), {}) kwargs:{'hostname': 'taskinit', 'request': {'retries': 0, 'loglevel': 10, 'delivery_info': {'consumer_tag': u'2', 'routing_key': u'celery', 'exchange': u'celery'}, 'is_eager': False, 'taskset': None, 'logfile': None, 'id': 'c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3'}})\n[2017-08-26 23:21:20,450: DEBUG/MainProcess] Task accepted: irgsh_web.build.tasks.UploadSource[c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3] pid:14269\nThe authenticity of host '[irgsh.blankonlinux.or.id]:2222 ([119.82.243.189]:2222)' can't be established.\nECDSA key fingerprint is SHA256:/Pw5PuRr/9yLdJ3rsh+PQocooznhj9XfxL30gARbmqU.\nAre you sure you want to continue connecting (yes/no)? yes\n")),(0,r.kt)("h3",{id:"build-macet-di-waiting-for-initialization"},"Build macet di Waiting for Initialization"),(0,r.kt)("p",null,"Cek ke log taskinit, lengkapi yang kurang. Contoh galat yang mungkin terjadi, "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'[2017-08-26 22:38:43,807: DEBUG/PoolWorker-8] Channel open\n[2017-08-26 22:38:43,814: DEBUG/PoolWorker-8] Closed channel #1\n[2017-08-26 22:38:43,852: ERROR/MainProcess] Task irgsh_web.build.tasks.InitSpecification[43f0e563-48e3-4759-8bd0-c9978360b2b4] raised exception: ImportError(\'No module named lzma\',)\nTraceback (most recent call last):\n  File "/home/irgsh-web/.pyenv/versions/irgsh-web/lib/python2.6/site-packages/celery/execute/trace.py", line 34, in trace\n    return cls(states.SUCCESS, retval=fun(*args, **kwargs))\n  File "/home/irgsh-web/.pyenv/versions/irgsh-web/lib/python2.6/site-packages/celery/task/base.py", line 241, in __call__\n    return self.run(*args, **kwargs)\n  File "/home/irgsh-web/irgsh-web/irgsh_web/build/tasks.py", line 33, in run\n    init.start()\n  File "/home/irgsh-web/irgsh-web/irgsh_web/build/utils.py", line 179, in start\n    def start(self):\n  File "/home/irgsh-web/irgsh-web/irgsh/source/__init__.py", line 1, in <module>\n    from .packager import SourcePackageBuilder\n  File "/home/irgsh-web/irgsh-web/irgsh/source/packager.py", line 10, in <module>\n    import lzma\nImportError: No module named lzma\n\nNone\n')),(0,r.kt)("h3",{id:"kode-sumber-tidak-dapat-diunduh"},"Kode sumber tidak dapat diunduh"),(0,r.kt)("p",null,"Galatnya seperti berikut"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"[2017-08-07 06:59:41,400: WARNING/PoolWorker-7] [Errno 13] Permission denied: '/run/irgsh-logs'\n")),(0,r.kt)("p",null,"dan "),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"Specification initialization failed: 'NoneType' object has no attribute 'write'\n")),(0,r.kt)("p",null,"Dikarenakan direktori ",(0,r.kt)("inlineCode",{parentName:"p"},"/run/irgsh-logs")," tidak ada. Setelah dibuat lalu mesin dimulai-ulang, direktori ini akan hilang dan perlu dibuat lagi. Jalan lupa permission baca tulisnya disetel juga."),(0,r.kt)("h3",{id:"galat-memorimemory-exeption"},"Galat memori'Memory exeption'"),(0,r.kt)("p",null,"Jika terjadi galat memori akan tampil pesan ",(0,r.kt)("inlineCode",{parentName:"p"},"<type> memory exeption ")," solusinya adalah dengan menambah kapasitas memori di mesin."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ sudo mkdir -p /run/irgsh-logs && sudo chmod a+rw /run/irgsh-logs\n")),(0,r.kt)("h3",{id:"x-not-installed"},"X not installed"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"}," -> Attempting to satisfy build-dependencies\n -> Creating pbuilder-satisfydepends-dummy package\nPackage: pbuilder-satisfydepends-dummy\nVersion: 0.invalid.0\nArchitecture: amd64\nMaintainer: Debian Pbuilder Team <pbuilder-maint@lists.alioth.debian.org>\nDescription: Dummy package to satisfy dependencies with aptitude - created by pbuilder\n This package was created automatically by pbuilder and should\nDepends: cdbs, debhelper (>= 10), dpkg-dev (>= 1.16.1~), libaccountsservice-dev (>= 0.6.39), desktop-file-utils, gnome-common, gnome-pkg-tools (>= 0.10), gnome-settings-daemon-dev (>= 3.19.1), gsettings-desktop-schemas-dev (>= 3.21.4), gtk-doc-tools, intltool (>= 0.37.1), libcanberra-gtk3-dev, libcheese-gtk-dev (>= 3.5.91), libcolord-dev (>= 0.1.29), libcolord-gtk-dev (>= 0.1.24), libcups2-dev, libgdk-pixbuf2.0-dev (>= 2.23.0), libgirepository1.0-dev, libglib2.0-dev (>= 2.44.0), libgnome-desktop-3-dev (>= 3.21.2), libgnomekbd-dev (>= 2.91.91), libgnome-bluetooth-dev (>= 3.18.0), libibus-1.0-dev (>= 1.5.2), libgoa-1.0-dev (>= 3.21.5), libgrilo-0.3-dev (>= 0.3.0), libgtk-3-dev (>= 3.22.0), libgtop2-dev, libgudev-1.0-dev, libkrb5-dev, libnm-dev (>= 1.2.0), libnma-dev (>= 1.2.0), libmm-glib-dev, libpolkit-gobject-1-dev (>= 0.103), libpulse-dev, libpwquality-dev, libsmbclient-dev (>= 2:3.6.12-1~), libupower-glib-dev (>= 0.99.0), libwacom-dev (>= 0.7), libxi-dev (>= 2:1.2), libx11-dev, libxft-dev (>= 2.1.2), libxklavier-dev (>= 5.1), libxml2-dev, locales, shared-mime-info, tzdata\ndpkg-deb: building package 'pbuilder-satisfydepends-dummy' in '/tmp/satisfydepends-aptitude/pbuilder-satisfydepends-dummy.deb'.\nReading package lists...\nBuilding dependency tree...\nReading state information...\naptitude is already the newest version (0.8.7-1).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nSelecting previously unselected package pbuilder-satisfydepends-dummy.\n(Reading database ... 17307 files and directories currently installed.)\nPreparing to unpack .../pbuilder-satisfydepends-dummy.deb ...\nUnpacking pbuilder-satisfydepends-dummy (0.invalid.0) ...\ndpkg: dependency problems prevent configuration of pbuilder-satisfydepends-dummy:\n pbuilder-satisfydepends-dummy depends on cdbs; however:\n  Package cdbs is not installed.\n pbuilder-satisfydepends-dummy depends on libaccountsservice-dev (>= 0.6.39); however:\n  Package libaccountsservice-dev is not installed.\n")),(0,r.kt)("p",null,"Masuk ke base.tgz ( dengan opsi --save-after-login dan --save-after-exec), lalu pasang paket terkait. Saat logout, perubahan akan tersimpan. Ulangi buildnya."),(0,r.kt)("h3",{id:"no-suitable-builder-found"},"No suitable builder found"),(0,r.kt)("p",null,"Hal ini disebabkan karena irgsh belum dapat menerima '''linux-any'''. Oleh karena itu, '''linux-any''' diganti menjadi '''any''' ketika terdapat pada '''architecture''' dan dihapus jika terdapat di dependensi paket."),(0,r.kt)("h3",{id:"build-gagal-banyak-paket-yang-404-di-buildloggz"},"Build gagal, banyak paket yang 404 di build.log.gz"),(0,r.kt)("p",null,"Kondisi paling dekat adalah reprepro sudah menarik index paket namun belum selesai mengunduh keseluruhan paket-paket aslinya."),(0,r.kt)("h3",{id:"build-gagal-setelah-langkah-uploading-package-dan-tidak-ada-laporan-dari-repolog"},"Build gagal setelah langkah ",(0,r.kt)("inlineCode",{parentName:"h3"},"Uploading package")," dan tidak ada laporan dari repo.log"),(0,r.kt)("p",null,"Cek ke user builder, lihat log ",(0,r.kt)("inlineCode",{parentName:"p"},"irgsh-uploader"),". Jika ada indikasi kegagalan unggah, ujicoba kembali akses ssh antar user terkait IRGSH satu sama lain melalui konfigurasi SSH bawaan (port 22). Misal dari ",(0,r.kt)("inlineCode",{parentName:"p"},"irgsh-builder-ajeng")," ke ",(0,r.kt)("inlineCode",{parentName:"p"},"irgsh-repo"),". Pastikan mereka bisa saling mengakses."),(0,r.kt)("h1",{id:"sertifikat"},"Sertifikat"),(0,r.kt)("p",null,"Sertifikat-sertifikat untuk keperluan irgsh terletak di ",(0,r.kt)("inlineCode",{parentName:"p"},"/cert/"),"."))}k.isMDXComponent=!0}}]);