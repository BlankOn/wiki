<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-TimPengembang/Infrastruktur/ImplementasiPabrikPaket">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Implementasi Pabrik Paket | BlankOn Linux</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://dev.blankonlinux.or.id/TimPengembang/Infrastruktur/ImplementasiPabrikPaket/"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Implementasi Pabrik Paket | BlankOn Linux"><meta data-rh="true" name="description" content="Cara Kerja"><meta data-rh="true" property="og:description" content="Cara Kerja"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://dev.blankonlinux.or.id/TimPengembang/Infrastruktur/ImplementasiPabrikPaket/"><link data-rh="true" rel="alternate" href="https://dev.blankonlinux.or.id/TimPengembang/Infrastruktur/ImplementasiPabrikPaket/" hreflang="en"><link data-rh="true" rel="alternate" href="https://dev.blankonlinux.or.id/TimPengembang/Infrastruktur/ImplementasiPabrikPaket/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://80516KNSUD-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="BlankOn Linux" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.dad2746d.css">
<link rel="preload" href="/assets/js/runtime~main.8103a87c.js" as="script">
<link rel="preload" href="/assets/js/main.9b713c1a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top navbarHideable_m1mJ"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.jpeg" alt="BlankOn Linux Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.jpeg" alt="BlankOn Linux Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">BlankOn</b></a><a class="navbar__item navbar__link" href="/Partisipasi/">Tim Pengembang</a><a class="navbar__item navbar__link" href="/ProdukBlankOn/">Produk</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/BlankOn" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="BlankOn Wiki"></a><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Implementasi Pabrik Paket</h1><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cara-kerja">Cara Kerja<a class="hash-link" href="#cara-kerja" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="kode-sumber">Kode sumber<a class="hash-link" href="#kode-sumber" title="Direct link to heading">​</a></h3><p>​<a href="https://code.launchpad.net/~blankon-infrastruktur/blankon/pabrik-paket" target="_blank" rel="noopener noreferrer">https://code.launchpad.net/~blankon-infrastruktur/blankon/pabrik-paket</a></p><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="karakteristik">Karakteristik<a class="hash-link" href="#karakteristik" title="Direct link to heading">​</a></h3><ul><li>Minimalis, mengandalkan hanya http biasa.</li><li>Catatan dilakukan dalam berkas teks biasa.</li><li>Komunikasi antara induk dan cabang dilakukan secara pasif, melalui
bantuan berkas teks biasa.</li></ul><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="induk">Induk<a class="hash-link" href="#induk" title="Direct link to heading">​</a></h3><p>Informasi yang diberikan:
Contoh saat ini, &lt;url-dasar<!-- -->&gt;<!-- -->nya adalah: ​<a href="http://irgsh.blankonlinux.or.id." target="_blank" rel="noopener noreferrer">http://irgsh.blankonlinux.or.id.</a>
Induk membuat berkas kerja baru pada direktori jobs/&lt;pekerjaan<!-- -->&gt;<!-- -->/
jobdesc.txt. Isi berkas ini adalah informasi pekerjaannya, yaitu nama tag, url
di gudang kode, url paket asli dari Ubuntu (berkas .orig.tar.gz), dan
distribusi pekerjaan (misalnya konde-updates, konde-security, dsb).</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tugas-induk-utama">Tugas Induk Utama<a class="hash-link" href="#tugas-induk-utama" title="Direct link to heading">​</a></h4><p>Tugas induk utama dikerjakan oleh skrip run-master.sh.</p><ol><li>Induk mengambil status semua cabang (mengunduh berkas status.txt) yang
memiliki status bukan IDLE (lihat bagian <em>Pengecekan Hasil</em>), serta
mengecek denyut nadi terakhir (berkas last-seen.txt). Bila cabang aktif
kurang dari 2 jam yang lalu maka cabang dianggap masih aktif. Isi berkas
status.txt menandakan apakah cabang sedang sibuk mengerjakan paket
(berisi kata BUSY), selesai mengerjakan paket (berisi kata DONE atau
ERROR) atau sedang menganggur (berisi kata IDLE). Bila cabang menganggur
ke langkah 6.</li><li>Induk memperbarui daftar paket siap bangun dari direktori queue, bila ada
paket baru ke langkah 3. Bila tidak ada paket baru, induk mengisi semua
berkas slaves/<!-- -->*<!-- -->/job.txt dengan kata NONE. Direktori queue adalah taut
simbolik ke direktori pekerjaan jobs, namun pada direktori pekerjaan
menggunakan tanda minus sebagai penghubung, misalnya pekerjaan di jobs/
200711/0010 akan muncul di queue/ sebagai queue/&lt;arsitektur<!-- -->&gt;<!-- -->/200711-0010.</li><li>Dari hasil langkah 1, induk menentukan cabang mana yang akan mengerjakan
paket baru ini. Bila tidak ada cabang yang menganggur maka kembali ke
langkah 1. Bila ada cabang yang menganggur induk segera menuliskan
&lt;nomor-pekerjaan<!-- -->&gt;<!-- --> tadi di dalam berkas slaves/&lt;nama-cabang<!-- -->&gt;<!-- -->/job.txt. Itu
tandanya cabang diberikan tugas untuk mengerjakan &lt;nomor-pekerjaan<!-- -->&gt;<!-- -->. Taut
simbolik di direktori queue dihapus.</li><li>Bila masih ada paket baru lagi yang belum dikerjakan kembali ke 2.</li><li>Induk beristirahat selama beberapa saat (450 detik). Kembali ke 1.</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pengecekan-hasil">Pengecekan Hasil<a class="hash-link" href="#pengecekan-hasil" title="Direct link to heading">​</a></h4><p>Pada bagian ini induk hanya mengecek semua paket yang telah selesai atau sedang
dikerjakan. Bagian ini dikerjakan oleh skrip get-result.sh
Induk mengunduh berkas status.txt dari semua cabang.
Bila berisi BUSY, induk mengunduh build-stage.txt.
Bila berisi ERROR, induk mengunduh berkas build-log.txt.bz2. Induk
kemudian menulis berkas slaves/&lt;nama-cabang<!-- -->&gt;<!-- -->/ack.txt dengan &lt;nomor-
pekerjaan<!-- -->&gt;<!-- -->. Tujuannya supaya cabang tahu bahwa induk sudah mengetahui
hasil kerja ini. Induk juga membersihkan status pekerjaan cabang
dengan menulis kata NONE pada slaves/&lt;nama-cabang<!-- -->&gt;<!-- -->/job.txt. Terakhir,
induk mengonfirmasi pekerjaan dengan menuliskan kata ERROR pada jobs/
&lt;nomor-pekerjaan<!-- -->&gt;<!-- -->/&lt;arsitektur<!-- -->&gt;<!-- -->/status.txt sekaligus mengirim surat
kepada pengirim paket.
Bila berisi DONE, induk mengunduh berkas manifest.txt dan mengambil
semua berkas yang tercantum dalam berkas manifest.txt ke dalam
direktori incoming/&lt;nama-cabang<!-- -->&gt;<!-- -->, kemudian menulis berkas slaves/
&lt;nama-cabang<!-- -->&gt;<!-- -->/ack.txt dengan &lt;nomor-pekerjaan<!-- -->&gt;<!-- -->. Tujuannya supaya
cabang tahu bahwa induk sudah mengunduh semua hasil pekerjaannya.
Induk juga membersihkan status pekerjaan cabang dengan menulis kata
NONE pada slaves/&lt;nama-cabang<!-- -->&gt;<!-- -->/job.txt. Kemudian, induk menyetujui
hasil kerja dengan menuliskan kata DONE pada jobs/&lt;nomor-pekerjaan<!-- -->&gt;<!-- -->/
&lt;arsitektur<!-- -->&gt;<!-- -->/status.txt. Terakhir induk akan memasukkan semua hasil
kerja ke repositori (Lihat bagian <em>Pengunggahan ke Repositori</em>)</p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pengunggahan-ke-repositori">Pengunggahan ke Repositori<a class="hash-link" href="#pengunggahan-ke-repositori" title="Direct link to heading">​</a></h4><p>Pengunggahan ke repositori dilakukan oleh bikin-arsip.sh.</p><ol><li>Skrip mencari semua berkas berakhiran .changes, dan dari tiap-tiap berkas
tersebut diambil semua berkas yang tercantum di dalamnya dan dimasukkan
ke dalam pool. Pabrik juga akan mengirim surat kepada pemaket yang
mengirimkan paket (yang tercantum dalam debian/changelog) bahwa paket
telah masuk ke repositori.</li><li>Berkas Packages, Packages.gz, Release, dan Release.gpg dibuat ulang dalam
masing-masing distribusi yang ada dalam repositori.</li></ol><h3 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="cabang">Cabang<a class="hash-link" href="#cabang" title="Direct link to heading">​</a></h3><p>Informasi yang diberikan:
Contoh saat ini, &lt;url-dasar<!-- -->&gt;<!-- -->nya adalah: ​<a href="http://tempayan.blankonlinux.or.id/" target="_blank" rel="noopener noreferrer">http://tempayan.blankonlinux.or.id/</a></p><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="tugas-induk-utama-1">Tugas induk utama<a class="hash-link" href="#tugas-induk-utama-1" title="Direct link to heading">​</a></h4><p>Tugas ini dikerjakan oleh berkas run-slave.sh.</p><ol><li>Bila status terakhir bukan IDLE maka cabang akan memeriksa apakah induk
telah mengonfirmasi hasil pekerjaan sebelumnya (pada &lt;url-induk<!-- -->&gt;<!-- -->/slaves/
arsitektur/&lt;nama-cabang<!-- -->&gt;<!-- -->/ack.txt). Bila berkas tersebut berisi nomor
pekerjaan yang sama dengan nomor sebelumnya, maka semua berkas dalam
direktori results/ akan dihapus.</li><li>Bila IDLE cabang akan memeriksa apakah cabang sedang diistirahatkan atau
tidak (dengan mengecek keberadaan berkas .slave-paused. Bila tidak,
cabang akan mengambil berkas &lt;url-induk<!-- -->&gt;<!-- -->/slaves/&lt;arsitektur<!-- -->&gt;<!-- -->/job.txt.<ol><li>Bila berisi NONE maka tidak ada yang perlu dilakukan cabang.</li><li>Bila berisi nomor pekerjaan baru, maka cabang akan mengambil berkas
job-desc.txt dari induk dan memrosesnya (Lihat <em>Pemrosesan Paket</em>).
Cabang juga mengisi berkas status.txt dengan kata BUSY.<ol><li>Bila pemrosesan paket berhasil (isi last-job-status.txt
berisi angka 0) maka cabang akan menyalin semua hasil
pemaketan dari pbuilder ke direktori results, kemudian
mendaftarkan semua berkas yang ada di direktori results ke
dalam berkas manifest.txt. Cabang juga mengisi berkas
status.txt dengan kata DONE.</li><li>Bila gagal (isi last-job-status.txt berisi angka 1 atau 2)
maka cabang akan mengisi berkas status.txt dengan kata ERROR
dan mengompres berkas build-log.txt menjadi build-
log.txt.bz2.</li></ol></li></ol></li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="pemrosesan-paket">Pemrosesan paket<a class="hash-link" href="#pemrosesan-paket" title="Direct link to heading">​</a></h4><p>Tugas ini dikerjakan oleh fungsi build_jobdesc pada berkas run-slave.sh.</p><ol><li>Mengunduh tag pada gudang kode.</li><li>Memeriksa apakah kode distribusi pada debian/changelog sama dengan
deskripsi yang telah diberikan melalui antarmuka web. Bila tidak sama,
maka pemrosesan gagal dengan kode 2.</li><li>Mengunduh tarball asli (bila ada). Tarbal diekstrak dan digabungkan
dengan paket yang diunduh dari gudang kode yang telah dilakukan pada
tahap 1.</li><li>Membuat berkas .dsc dan .tar.gz dengan dpkg-source.</li><li>Memperbarui lingkungan pembangunan di pbuilder (apt-get upgrade). Bila
gagal, maka proses diberi kode 1.</li><li>Melakukan pembangunan di pbuilder. Bila gagal, maka proses diberi kode 2.</li></ol><h4 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="kode-hasil-pemrosesan-paket">Kode hasil pemrosesan paket<a class="hash-link" href="#kode-hasil-pemrosesan-paket" title="Direct link to heading">​</a></h4><p>0 Paket sukses dibuat
1 proses pemaketan gagal tapi dapat diulangi (ada kesalahan kecil di
repositori atau tag atau url)
2 berarti proses pemaketan gagal dan tidak dapat diulangi, artinya
pemaket harus membuat tiket baru.</p><h2 class="anchor anchorWithHideOnScrollNavbar_WYt5" id="implementasi-dan-instalasi">Implementasi dan instalasi<a class="hash-link" href="#implementasi-dan-instalasi" title="Direct link to heading">​</a></h2><ul><li>Pabrik Induk?</li><li>Pabrik_Cabang</li></ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/BlankOn/wiki/commits/master/TimPengembang/Infrastruktur/ImplementasiPabrikPaket.md" target="_blank" rel="noreferrer noopener" style="margin-right:15px" class="theme-edit-this-page"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16" style="margin-right:0.3em;vertical-align:sub"><path fill-rule="evenodd" d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"></path></svg>Page History</a><a href="https://github.com/BlankOn/wiki/edit/master/TimPengembang/Infrastruktur/ImplementasiPabrikPaket.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_VsjB"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cara-kerja" class="table-of-contents__link toc-highlight">Cara Kerja</a><ul><li><a href="#kode-sumber" class="table-of-contents__link toc-highlight">Kode sumber</a></li><li><a href="#karakteristik" class="table-of-contents__link toc-highlight">Karakteristik</a></li><li><a href="#induk" class="table-of-contents__link toc-highlight">Induk</a></li><li><a href="#cabang" class="table-of-contents__link toc-highlight">Cabang</a></li></ul></li><li><a href="#implementasi-dan-instalasi" class="table-of-contents__link toc-highlight">Implementasi dan instalasi</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a href="https://blankonlinux.or.id" rel="noopener noreferrer" class="footerLogoLink_BH7S"><img src="/img/logo-hitam.png" alt="BlankOn Linux" class="themedImage_ToTc themedImage--light_HNdA footer__logo"><img src="/img/logo-hitam.png" alt="BlankOn Linux" class="themedImage_ToTc themedImage--dark_i4oU footer__logo"></a></div><div class="footer__copyright">Copyright © 2022 BlankOn Linux. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.8103a87c.js"></script>
<script src="/assets/js/main.9b713c1a.js"></script>
</body>
</html>