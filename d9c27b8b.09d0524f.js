(window.webpackJsonp=window.webpackJsonp||[]).push([[844],{1047:function(e,a,n){"use strict";n.d(a,"a",(function(){return b}));var t=n(0),i=n.n(t);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function l(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function u(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?l(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function p(e,a){if(null==e)return{};var n,t,i=function(e,a){if(null==e)return{};var n,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(i[n]=e[n]);return i}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=i.a.createContext({}),o=function(e){var a=i.a.useContext(c),n=a;return e&&(n="function"==typeof e?e(a):u(u({},a),e)),n},s={inlineCode:"code",wrapper:function(e){var a=e.children;return i.a.createElement(i.a.Fragment,{},a)}},d=i.a.forwardRef((function(e,a){var n=e.components,t=e.mdxType,r=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=o(n),b=t,g=d["".concat(l,".").concat(b)]||d[b]||s[b]||r;return n?i.a.createElement(g,u(u({ref:a},c),{},{components:n})):i.a.createElement(g,u({ref:a},c))}));function b(e,a){var n=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var r=n.length,l=new Array(r);l[0]=d;var u={};for(var p in a)hasOwnProperty.call(a,p)&&(u[p]=a[p]);u.originalType=e,u.mdxType="string"==typeof e?e:t,l[1]=u;for(var c=2;c<r;c++)l[c]=n[c];return i.a.createElement.apply(null,l)}return i.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},913:function(e,a,n){"use strict";n.r(a),n.d(a,"frontMatter",(function(){return l})),n.d(a,"metadata",(function(){return u})),n.d(a,"rightToc",(function(){return p})),n.d(a,"default",(function(){return o}));var t=n(3),i=n(7),r=(n(0),n(1047)),l={},u={unversionedId:"TimPengembang/Pemaket/PanduanIrgshCLIUntukPemaket",id:"TimPengembang/Pemaket/PanduanIrgshCLIUntukPemaket",isDocsHomePage:!1,title:"PanduanIrgshCLIUntukPemaket",description:"Panduan irgsh-cli untuk Pemaket",source:"@site/Wiki/TimPengembang/Pemaket/PanduanIrgshCLIUntukPemaket.md",slug:"/TimPengembang/Pemaket/PanduanIrgshCLIUntukPemaket",permalink:"/TimPengembang/Pemaket/PanduanIrgshCLIUntukPemaket",editUrl:"https://github.com/BlankOn/wiki/edit/master/Wiki/TimPengembang/Pemaket/PanduanIrgshCLIUntukPemaket.md",version:"current"},p=[{value:"GPG",id:"gpg",children:[{value:"Kebutuhan",id:"kebutuhan",children:[]},{value:"Generate",id:"generate",children:[]},{value:"Ekspor",id:"ekspor",children:[]},{value:"Hapus",id:"hapus",children:[]}]},{value:"Pendaftaran kunci pemaket ke irgsh",id:"pendaftaran-kunci-pemaket-ke-irgsh",children:[]},{value:"irgsh-cli",id:"irgsh-cli",children:[{value:"Kebutuhan",id:"kebutuhan-1",children:[]},{value:"Pemasangan",id:"pemasangan",children:[]},{value:"Konfigurasi awal",id:"konfigurasi-awal",children:[]},{value:"Pemaketan dengan irgsh-cli",id:"pemaketan-dengan-irgsh-cli",children:[]}]},{value:"Sidik Gangguan",id:"sidik-gangguan",children:[{value:"Kunci privat tidak dikenali",id:"kunci-privat-tidak-dikenali",children:[]},{value:"Permission denied di tty",id:"permission-denied-di-tty",children:[]}]}],c={rightToc:p};function o(e){var a=e.components,n=Object(i.a)(e,["components"]);return Object(r.a)("wrapper",Object(t.a)({},c,n,{components:a,mdxType:"MDXLayout"}),Object(r.a)("h1",{id:"panduan-irgsh-cli-untuk-pemaket"},"Panduan irgsh-cli untuk Pemaket"),Object(r.a)("h2",{id:"gpg"},"GPG"),Object(r.a)("h3",{id:"kebutuhan"},"Kebutuhan"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},Object(r.a)("inlineCode",{parentName:"li"},"apt install gnupg build-essential devscripts debhelper"))),Object(r.a)("h3",{id:"generate"},"Generate"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"gnupg --full-generate-key\n")),Object(r.a)("p",null,"Dalam proses akan ditanyakan informasi entitas dan kunci, contoh:"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"gpg (GnuPG) 2.2.20; Copyright (C) 2020 Free Software Foundation, Inc.\nThis is free software: you are free to change and redistribute it.\nThere is NO WARRANTY, to the extent permitted by law.arsip-dev.blankonlinux.or.id/\n\nPlease select what kind of key you want:\n   (1) RSA and RSA (default)\n   (2) DSA and Elgamal\n   (3) DSA (sign only)\n   (4) RSA (sign only)\n  (14) Existing key from card\nYour selection? 1\nRSA keys may be between 1024 and 4096 bits long.\nWhat keysize do you want? (3072) 4096\nRequested keysize is 4096 bits\nPlease specify how long the key should be valid.\n         0 = key does not expire\n      <n>  = key expires in n days\n      <n>w = key expires in n weeks\n      <n>m = key expires in n months\n      <n>y = key expires in n years\nKey is valid for? (0) 5y\nKey expires at Thu 20 Nov 2025 07:49:07 PM WIB\nIs this correct? (y/N) y\n\nGnuPG needs to construct a user ID to identify your key.\n\nReal name: Herpiko Dwi Aguno\nEmail address: herpiko@gmail.com\nComment: \nYou selected this USER-ID:\n    \"Herpiko Dwi Aguno <herpiko@gmail.com>\"\n\nChange (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O\nWe need to generate a lot of random bytes. It is a good idea to perform\nsome other action (type on the keyboard, move the mouse, utilize the\ndisks) during the prime generation; this gives the random number\ngenerator a better chance to gain enough entropy.\noienienoienoienoienoienoienoienoienoienoienoienoiengpg: key F73403755814255E marked as ultimately trusted\ngpg: directory '/home/herpiko/.gnupg/openpgp-revocs.d' created\noienoiegpg: revocation certificate stored as '/home/herpiko/.gnupg/openpgp-revocs.d/4E1C6A31FB1DF66463806857F73403755814255E.rev'\npublic and secret key created and signed.\n\npub   rsa4096 2020-11-21 [SC] [expires: 2025-11-20]\n      4E1C6A31FB1DF66463806857F73403755814255E\nuid                      Herpiko Dwi Aguno <herpiko@gmail.com>\nsub   rsa4096 2020-11-21 [E] [expires: 2025-11-20]\n")),Object(r.a)("p",null,"Lihat kunci yang sudah dibikin dengan,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"gnupg -K\n")),Object(r.a)("h3",{id:"ekspor"},"Ekspor"),Object(r.a)("p",null,"Salin terlebih dahulu identitas kuncinya. Lihat identitas kunci yang ada dengan perintah ",Object(r.a)("inlineCode",{parentName:"p"},"gpg -K"),". Outputnya:"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"/home/herpiko/.gnupg/pubring.kbx\n--------------------------------\nsec   rsa4096 2020-11-21 [SC] [expires: 2025-11-20]\n      4E1C6A31FB1DF66463806857F73403755814255E\nuid           [ultimate] Herpiko Dwi Aguno <herpiko@gmail.com>\nssb   rsa4096 2020-11-21 [E] [expires: 2025-11-20]\n")),Object(r.a)("p",null,"Di kasus output di atas, identitas kuncinya adalah ",Object(r.a)("inlineCode",{parentName:"p"},"4E1C6A31FB1DF66463806857F73403755814255E"),"."),Object(r.a)("p",null,"Kemudian coba ekspor kunci publiknya dengan perintah,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"gpg --armor --export 4E1C6A31FB1DF66463806857F73403755814255E > namapemaket-gpg-pubkey\n")),Object(r.a)("p",null,"Sampai di sini, kuncinya dapat diserahkan ke tim infra untuk disuntikkan ke GPG keystore irgsh."),Object(r.a)("h3",{id:"hapus"},"Hapus"),Object(r.a)("p",null,"Menghapus kunci cukup dengan perintah,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"gpg --delete-key 4E1C6A31FB1DF66463806857F73403755814255E\n")),Object(r.a)("h2",{id:"pendaftaran-kunci-pemaket-ke-irgsh"},"Pendaftaran kunci pemaket ke irgsh"),Object(r.a)("p",null,"Bagian ini dilakukan oleh Tim Infra."),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Bawa kunci-kunci yang mau diimpor ke mesin irgsh, misal dengan ",Object(r.a)("inlineCode",{parentName:"li"},"scp")),Object(r.a)("li",{parentName:"ul"},"Masuk ke user ",Object(r.a)("inlineCode",{parentName:"li"},"irgsh")),Object(r.a)("li",{parentName:"ul"},"Impor dengan perintah ",Object(r.a)("inlineCode",{parentName:"li"},"gpg --import < /path/to/pub.key")),Object(r.a)("li",{parentName:"ul"},"setelah diimpor, pastikan kuncinya terdaftar dengan perintah ",Object(r.a)("inlineCode",{parentName:"li"},"gpg --list-key"))),Object(r.a)("h2",{id:"irgsh-cli"},"irgsh-cli"),Object(r.a)("h3",{id:"kebutuhan-1"},"Kebutuhan"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Turunan Debian"),Object(r.a)("li",{parentName:"ul"},Object(r.a)("inlineCode",{parentName:"li"},"apt install gnupg curl jq tar build-essential devscripts debhelper"))),Object(r.a)("h3",{id:"pemasangan"},"Pemasangan"),Object(r.a)("p",null,"Pasang ",Object(r.a)("inlineCode",{parentName:"p"},"irgsh-cli")," dengan perintah satu baris berikut,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"curl -L -o- https://raw.githubusercontent.com/BlankOn/irgsh-go/master/install-cli.sh | bash\n")),Object(r.a)("p",null,"Bila sudah selesai, akan tampil output seperti di bawah ini yang menandakan irgsh-cli siap dipakai,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"/tmp /tmp\nExtracting ... \nExtracting [OK]\n\nInstalling files ... \n'/tmp/irgsh-go/usr/bin/irgsh-cli' -> '/usr/bin/irgsh-cli'\nHappy hacking!\n")),Object(r.a)("h3",{id:"konfigurasi-awal"},"Konfigurasi awal"),Object(r.a)("p",null,"Sebelum mengkonfigurasi ",Object(r.a)("inlineCode",{parentName:"p"},"irgsh-cli"),", pemaket perlu mengkonfirmasi ke Tim Infra di mana ",Object(r.a)("inlineCode",{parentName:"p"},"irgsh-chief")," (induk dari komponen-komponen irgsh) dinyalakan. Dalam lokakarya ini, induk irgsh hidup di ",Object(r.a)("inlineCode",{parentName:"p"},"https://irgsh.blankonlinux.or.id"),"."),Object(r.a)("p",null,"Kemudian konfigurasikan ",Object(r.a)("inlineCode",{parentName:"p"},"irgsh-cli")," dengan perintah berikut,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"irgsh-cli config --chief https://irgsh.blankonlinux.or.id --key 4E1C6A31FB1DF66463806857F73403755814255E\n")),Object(r.a)("p",null,"Sampai di sini, ",Object(r.a)("inlineCode",{parentName:"p"},"irgsh-cli")," akan bekerja dengan induk irgsh ",Object(r.a)("a",Object(t.a)({parentName:"p"},{href:"https://irgsh.blankonlinux.or.id"}),"https://irgsh.blankonlinux.or.id")," menggunakan kunci pemaket ",Object(r.a)("inlineCode",{parentName:"p"},"4E1C6A31FB1DF66463806857F73403755814255E"),"."),Object(r.a)("h3",{id:"pemaketan-dengan-irgsh-cli"},"Pemaketan dengan irgsh-cli"),Object(r.a)("p",null,"Pemaket membutuhkan setidaknya 2 hal untuk memaketkan paket ke irgsh, yaitu:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Spesifikasi Debian (",Object(r.a)("a",Object(t.a)({parentName:"li"},{href:"https://github.com/blankon-packages"}),"https://github.com/blankon-packages"),")"),Object(r.a)("li",{parentName:"ul"},"Kode sumber (fitur opsional menunggu tiket ",Object(r.a)("a",Object(t.a)({parentName:"li"},{href:"https://github.com/BlankOn/irgsh-go/issues/78"}),"https://github.com/BlankOn/irgsh-go/issues/78"),")")),Object(r.a)("p",null,"Keduanya didefinisikan dengan URL lumbung kode (bisa dari mana pun yang penting dapat diakses oleh internet dan sifatnya publik)."),Object(r.a)("p",null,"Misal kita akan mencoba untuk memaketkan ",Object(r.a)("inlineCode",{parentName:"p"},"bromo-theme")," dengan bahan di bawah ini:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Spesifikasi Debian: ",Object(r.a)("a",Object(t.a)({parentName:"li"},{href:"https://github.com/blankon-packages/bromo-theme"}),"https://github.com/blankon-packages/bromo-theme")),Object(r.a)("li",{parentName:"ul"},"Kode sumber: ",Object(r.a)("a",Object(t.a)({parentName:"li"},{href:"https://github.com/blankon/bromo-theme"}),"https://github.com/blankon/bromo-theme"))),Object(r.a)("p",null,"Setelah keduanya disiapkan, pemaket dapat menyuntikkan paket ke irgsh dengan perintah berikut,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"irgsh-cli submit --source https://github.com/blankon/bromo-theme --package https://github.com/blankon-packages/bromo-theme --experimental\n")),Object(r.a)("p",null,"Flag ",Object(r.a)("inlineCode",{parentName:"p"},"--experimental")," menandakan paket ini akan disuntikkan ke lumbung experimental alih-alih ke lumbung pengembangan resmi. Tujuannya untuk uji coba sebelum benar-benar dipaketkan ke lumbung."),Object(r.a)("p",null,"Lumbung pengembangan resmi terletak di arsip-dev.blankonlinux.or.id. Untuk paket experimental akan disuntik ke arsip-dev.blankonlinux.or.id/experimental, sementara paket resmi masuk ke arsip-dev.blankonlinux.or.id/dev."),Object(r.a)("p",null,"Untuk memantau proses pembangunan paket, gunakan perintah berikut:"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"irgsh-cli log\n")),Object(r.a)("p",null,"Atau dengan membubuhkan id pipeline,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"irgsh-cli log 2020-11-21-205136_b8dbbd86-0ee1-409a-b3e3-4ec4d97c5302\n")),Object(r.a)("h2",{id:"sidik-gangguan"},"Sidik Gangguan"),Object(r.a)("h3",{id:"kunci-privat-tidak-dikenali"},"Kunci privat tidak dikenali"),Object(r.a)("p",null,"Pesan galat menyerupai,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),'gpg: skipped "41B4FC0A57E7F7F8DD94E0AA2D21BB5FAA32AF3F": No secret key\ngpg: /tmp/debsign.QNCSozgK/blankon-keyring_2016.09.04-4.2.dsc: clear-sign failed: No secret key\ndebsign: gpg error occurred!  Aborting....\ndebuild: fatal error at line 1112:\nrunning debsign failed\n')),Object(r.a)("p",null,"Antara lain mungkin disebabkan oleh:"),Object(r.a)("ul",null,Object(r.a)("li",{parentName:"ul"},"Identitas kunci untuk menandatangani paket belum ditetapkan atau tidak cocok dengan yang ada di kantong kunci GPG Anda. Silakan ditetap dengan perintah, ",Object(r.a)("inlineCode",{parentName:"li"},"rgsh-cli config --chief https://irgsh.blankonlinux.or.id --key YOURKEYIDENTITY")),Object(r.a)("li",{parentName:"ul"},"Nama dan alamat surat elektronik perawat paket yang ada di berkas ",Object(r.a)("inlineCode",{parentName:"li"},"debian/changelog")," tidak cocok dengan identitas kunci yang ada di kantong kunci GPG Anda. Silakan sesuaikan lagi berkas tersebut.")),Object(r.a)("h3",{id:"permission-denied-di-tty"},"Permission denied di tty"),Object(r.a)("p",null,"Galatnya,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"gpg: agent_genkey failed: Permission denied\nKey generation failed: Permission denied\n")),Object(r.a)("p",null,"Biasanya terjadi bila mencoba generate gpg namun dalam sesi SSH. Solusinya coba generate ulang namun dalam tmux atau cek kepemilikan sesi tty dengan,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"ls -l $(tty)\n")),Object(r.a)("p",null,"Lalu geser kepemilikannya dengan,"),Object(r.a)("pre",null,Object(r.a)("code",Object(t.a)({parentName:"pre"},{}),"chown namapengguna /dev/pts/0\n")))}o.isMDXComponent=!0}}]);