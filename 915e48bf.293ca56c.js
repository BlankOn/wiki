(window.webpackJsonp=window.webpackJsonp||[]).push([[532],{1022:function(e,a,n){"use strict";n.d(a,"a",(function(){return u})),n.d(a,"b",(function(){return g}));var i=n(0),t=n.n(i);function r(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function l(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);a&&(i=i.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?l(Object(n),!0).forEach((function(a){r(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function s(e,a){if(null==e)return{};var n,i,t=function(e,a){if(null==e)return{};var n,i,t={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],a.indexOf(n)>=0||(t[n]=e[n]);return t}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(t[n]=e[n])}return t}var b=t.a.createContext({}),o=function(e){var a=t.a.useContext(b),n=a;return e&&(n="function"==typeof e?e(a):d(d({},a),e)),n},u=function(e){var a=o(e.components);return t.a.createElement(b.Provider,{value:a},e.children)},c={inlineCode:"code",wrapper:function(e){var a=e.children;return t.a.createElement(t.a.Fragment,{},a)}},p=t.a.forwardRef((function(e,a){var n=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,b=s(e,["components","mdxType","originalType","parentName"]),u=o(n),p=i,g=u["".concat(l,".").concat(p)]||u[p]||c[p]||r;return n?t.a.createElement(g,d(d({ref:a},b),{},{components:n})):t.a.createElement(g,d({ref:a},b))}));function g(e,a){var n=arguments,i=a&&a.mdxType;if("string"==typeof e||i){var r=n.length,l=new Array(r);l[0]=p;var d={};for(var s in a)hasOwnProperty.call(a,s)&&(d[s]=a[s]);d.originalType=e,d.mdxType="string"==typeof e?e:i,l[1]=d;for(var b=2;b<r;b++)l[b]=n[b];return t.a.createElement.apply(null,l)}return t.a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},588:function(e,a,n){"use strict";n.r(a),n.d(a,"frontMatter",(function(){return l})),n.d(a,"metadata",(function(){return d})),n.d(a,"rightToc",(function(){return s})),n.d(a,"default",(function(){return o}));var i=n(2),t=n(6),r=(n(0),n(1022)),l={},d={unversionedId:"TimPengembang/Infrastruktur/IRGSH",id:"TimPengembang/Infrastruktur/IRGSH",isDocsHomePage:!1,title:"IRGSH",description:"Menjalankan irgsh di rani :",source:"@site/Wiki/TimPengembang/Infrastruktur/IRGSH.md",slug:"/TimPengembang/Infrastruktur/IRGSH",permalink:"/TimPengembang/Infrastruktur/IRGSH",editUrl:"https://github.com/BlankOn/wiki/edit/master/Wiki/TimPengembang/Infrastruktur/IRGSH.md",version:"current"},s=[{value:"irgsh-web",id:"irgsh-web",children:[{value:"web",id:"web",children:[]},{value:"taskinit",id:"taskinit",children:[]}]},{value:"irgsh-node",id:"irgsh-node",children:[]},{value:"irgsh-repo",id:"irgsh-repo",children:[{value:"error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system",id:"error140b0002ssl-routinesssl_ctx_use_privatekey_filesystem",children:[]},{value:"Unduhan via source type Git macet",id:"unduhan-via-source-type-git-macet",children:[]},{value:"Build macet di Waiting for Initialization",id:"build-macet-di-waiting-for-initialization",children:[]},{value:"Kode sumber tidak dapat diunduh",id:"kode-sumber-tidak-dapat-diunduh",children:[]},{value:"Galat memori&#39;Memory exeption&#39;",id:"galat-memorimemory-exeption",children:[]},{value:"X not installed",id:"x-not-installed",children:[]},{value:"No suitable builder found",id:"no-suitable-builder-found",children:[]},{value:"Build gagal, banyak paket yang 404 di build.log.gz",id:"build-gagal-banyak-paket-yang-404-di-buildloggz",children:[]},{value:"Build gagal setelah langkah <code>Uploading package</code> dan tidak ada laporan dari repo.log",id:"build-gagal-setelah-langkah-uploading-package-dan-tidak-ada-laporan-dari-repolog",children:[]}]}],b={rightToc:s};function o(e){var a=e.components,n=Object(t.a)(e,["components"]);return Object(r.b)("wrapper",Object(i.a)({},b,n,{components:a,mdxType:"MDXLayout"}),Object(r.b)("h1",{id:"menjalankan-irgsh-di-rani-"},"Menjalankan irgsh di ",Object(r.b)("inlineCode",{parentName:"h1"},"rani")," :"),Object(r.b)("p",null,"Masuk sebagai user ",Object(r.b)("inlineCode",{parentName:"p"},"irgsh")),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"$ sudo -u irgsh -i\n")),Object(r.b)("p",null,"pindah direktori kerja ke direktori web irgsh"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"irgsh$ cd v2/web-interfaces\n")),Object(r.b)("p",null,"Jalankan script fastcgi"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"irgsh$ ./run-fastcgi-2.sh\n")),Object(r.b)("p",null,"Gunakan ",Object(r.b)("inlineCode",{parentName:"p"},"tmux")," atau ",Object(r.b)("inlineCode",{parentName:"p"},"screen")," untuk manjalankan skrip taskinit"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"irgsh$ tmux ### atau screen\n")),Object(r.b)("p",null,"jalankan skrip taskinit"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"irgsh$ ./run-taskinit-2.sh\n")),Object(r.b)("p",null,"detach dari ",Object(r.b)("em",{parentName:"p"},"tmux")," atau ",Object(r.b)("em",{parentName:"p"},"screen")),Object(r.b)("h1",{id:"menjalankan-irgsh-di-alynne-"},"Menjalankan irgsh di ",Object(r.b)("inlineCode",{parentName:"h1"},"alynne")," :"),Object(r.b)("h2",{id:"irgsh-web"},"irgsh-web"),Object(r.b)("h3",{id:"web"},"web"),Object(r.b)("p",null,"Masuk sebagai user irgsh, pindah ke ",Object(r.b)("inlineCode",{parentName:"p"},"/home/irgsh/irgsh-web/"),", lalu :"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"$ python manage.py runfcgi method=prefork host=0.0.0.0 port=8001\n")),Object(r.b)("h3",{id:"taskinit"},"taskinit"),Object(r.b)("p",null,"Masuk sebagai user irgsh, pindah ke ",Object(r.b)("inlineCode",{parentName:"p"},"/home/irgsh/irgsh-web/"),", bikin screen baru, lalu :"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"$ python manage.py celeryd -n taskinit -l DEBUG\n")),Object(r.b)("h2",{id:"irgsh-node"},"irgsh-node"),Object(r.b)("p",null,"Masuk sebagai user builder, pindah ke ",Object(r.b)("inlineCode",{parentName:"p"},"/home/builder/irgsh-node"),", bikin screen baru, lalu :"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"$ ./bin/irgsh-node -l DEBUG\n")),Object(r.b)("p",null,"Untuk uploader, bikin screen baru, lalu :"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"$ ./bin/irgsh-uploader -l DEBUG\n")),Object(r.b)("h2",{id:"irgsh-repo"},"irgsh-repo"),Object(r.b)("p",null,"Masuk sebagai user irgsh-repo, pindah ke ",Object(r.b)("inlineCode",{parentName:"p"},"/home/irgsh-repo/irgsh-repo"),", bikin screen baru, lalu :"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"$ sudo ./bin/irgsh-repo -l DEBUG\n")),Object(r.b)("h1",{id:"sidik-gangguan"},"Sidik gangguan"),Object(r.b)("h3",{id:"error140b0002ssl-routinesssl_ctx_use_privatekey_filesystem"},"error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"[2017-08-26 23:39:48,111: ERROR/MainProcess] Consumer: Connection Error: [Errno 336265218] _ssl.c:347: error:140B0002:SSL routines:SSL_CTX_use_PrivateKey_file:system lib. Trying again in 4 seconds...\n")),Object(r.b)("p",null,"Cek sertifikat dan kunci private milik builder terkait. Berkas sertifikat dan kunci tersebut mesti bisa dibaca oleh user yang menjalankan builder / irgsh-node."),Object(r.b)("h3",{id:"unduhan-via-source-type-git-macet"},"Unduhan via source type Git macet"),Object(r.b)("p",null,"Cek ke log taskinit, jawab yes, "),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"[2017-08-26 23:21:20,448: DEBUG/MainProcess] Mediator: Running callback for task: irgsh_web.build.tasks.UploadSource[c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3]\n[2017-08-26 23:21:20,449: DEBUG/MainProcess] TaskPool: Apply <function execute_and_trace at 0x562655c397d0> (args:('irgsh_web.build.tasks.UploadSource', 'c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3', (9721, [u'aglfn_1.7-3blankon1.dsc', u'aglfn_1.7.orig.tar.gz', u'aglfn_1.7-3blankon1.debian.tar.xz']), {}) kwargs:{'hostname': 'taskinit', 'request': {'retries': 0, 'loglevel': 10, 'delivery_info': {'consumer_tag': u'2', 'routing_key': u'celery', 'exchange': u'celery'}, 'is_eager': False, 'taskset': None, 'logfile': None, 'id': 'c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3'}})\n[2017-08-26 23:21:20,450: DEBUG/MainProcess] Task accepted: irgsh_web.build.tasks.UploadSource[c55c0fbf-6822-4f1f-8505-dd22aa8ac8a3] pid:14269\nThe authenticity of host '[irgsh.blankonlinux.or.id]:2222 ([119.82.243.189]:2222)' can't be established.\nECDSA key fingerprint is SHA256:/Pw5PuRr/9yLdJ3rsh+PQocooznhj9XfxL30gARbmqU.\nAre you sure you want to continue connecting (yes/no)? yes\n")),Object(r.b)("h3",{id:"build-macet-di-waiting-for-initialization"},"Build macet di Waiting for Initialization"),Object(r.b)("p",null,"Cek ke log taskinit, lengkapi yang kurang. Contoh galat yang mungkin terjadi, "),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),'[2017-08-26 22:38:43,807: DEBUG/PoolWorker-8] Channel open\n[2017-08-26 22:38:43,814: DEBUG/PoolWorker-8] Closed channel #1\n[2017-08-26 22:38:43,852: ERROR/MainProcess] Task irgsh_web.build.tasks.InitSpecification[43f0e563-48e3-4759-8bd0-c9978360b2b4] raised exception: ImportError(\'No module named lzma\',)\nTraceback (most recent call last):\n  File "/home/irgsh-web/.pyenv/versions/irgsh-web/lib/python2.6/site-packages/celery/execute/trace.py", line 34, in trace\n    return cls(states.SUCCESS, retval=fun(*args, **kwargs))\n  File "/home/irgsh-web/.pyenv/versions/irgsh-web/lib/python2.6/site-packages/celery/task/base.py", line 241, in __call__\n    return self.run(*args, **kwargs)\n  File "/home/irgsh-web/irgsh-web/irgsh_web/build/tasks.py", line 33, in run\n    init.start()\n  File "/home/irgsh-web/irgsh-web/irgsh_web/build/utils.py", line 179, in start\n    def start(self):\n  File "/home/irgsh-web/irgsh-web/irgsh/source/__init__.py", line 1, in <module>\n    from .packager import SourcePackageBuilder\n  File "/home/irgsh-web/irgsh-web/irgsh/source/packager.py", line 10, in <module>\n    import lzma\nImportError: No module named lzma\n\nNone\n')),Object(r.b)("h3",{id:"kode-sumber-tidak-dapat-diunduh"},"Kode sumber tidak dapat diunduh"),Object(r.b)("p",null,"Galatnya seperti berikut"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"[2017-08-07 06:59:41,400: WARNING/PoolWorker-7] [Errno 13] Permission denied: '/run/irgsh-logs'\n")),Object(r.b)("p",null,"dan "),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{}),"Specification initialization failed: 'NoneType' object has no attribute 'write'\n")),Object(r.b)("p",null,"Dikarenakan direktori ",Object(r.b)("inlineCode",{parentName:"p"},"/run/irgsh-logs")," tidak ada. Setelah dibuat lalu mesin dimulai-ulang, direktori ini akan hilang dan perlu dibuat lagi. Jalan lupa permission baca tulisnya disetel juga."),Object(r.b)("h3",{id:"galat-memorimemory-exeption"},"Galat memori'Memory exeption'"),Object(r.b)("p",null,"Jika terjadi galat memori akan tampil pesan ",Object(r.b)("inlineCode",{parentName:"p"},"<type> memory exeption ")," solusinya adalah dengan menambah kapasitas memori di mesin."),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{className:"language-bash"}),"$ sudo mkdir -p /run/irgsh-logs && sudo chmod a+rw /run/irgsh-logs\n")),Object(r.b)("h3",{id:"x-not-installed"},"X not installed"),Object(r.b)("pre",null,Object(r.b)("code",Object(i.a)({parentName:"pre"},{})," -> Attempting to satisfy build-dependencies\n -> Creating pbuilder-satisfydepends-dummy package\nPackage: pbuilder-satisfydepends-dummy\nVersion: 0.invalid.0\nArchitecture: amd64\nMaintainer: Debian Pbuilder Team <pbuilder-maint@lists.alioth.debian.org>\nDescription: Dummy package to satisfy dependencies with aptitude - created by pbuilder\n This package was created automatically by pbuilder and should\nDepends: cdbs, debhelper (>= 10), dpkg-dev (>= 1.16.1~), libaccountsservice-dev (>= 0.6.39), desktop-file-utils, gnome-common, gnome-pkg-tools (>= 0.10), gnome-settings-daemon-dev (>= 3.19.1), gsettings-desktop-schemas-dev (>= 3.21.4), gtk-doc-tools, intltool (>= 0.37.1), libcanberra-gtk3-dev, libcheese-gtk-dev (>= 3.5.91), libcolord-dev (>= 0.1.29), libcolord-gtk-dev (>= 0.1.24), libcups2-dev, libgdk-pixbuf2.0-dev (>= 2.23.0), libgirepository1.0-dev, libglib2.0-dev (>= 2.44.0), libgnome-desktop-3-dev (>= 3.21.2), libgnomekbd-dev (>= 2.91.91), libgnome-bluetooth-dev (>= 3.18.0), libibus-1.0-dev (>= 1.5.2), libgoa-1.0-dev (>= 3.21.5), libgrilo-0.3-dev (>= 0.3.0), libgtk-3-dev (>= 3.22.0), libgtop2-dev, libgudev-1.0-dev, libkrb5-dev, libnm-dev (>= 1.2.0), libnma-dev (>= 1.2.0), libmm-glib-dev, libpolkit-gobject-1-dev (>= 0.103), libpulse-dev, libpwquality-dev, libsmbclient-dev (>= 2:3.6.12-1~), libupower-glib-dev (>= 0.99.0), libwacom-dev (>= 0.7), libxi-dev (>= 2:1.2), libx11-dev, libxft-dev (>= 2.1.2), libxklavier-dev (>= 5.1), libxml2-dev, locales, shared-mime-info, tzdata\ndpkg-deb: building package 'pbuilder-satisfydepends-dummy' in '/tmp/satisfydepends-aptitude/pbuilder-satisfydepends-dummy.deb'.\nReading package lists...\nBuilding dependency tree...\nReading state information...\naptitude is already the newest version (0.8.7-1).\n0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded.\nSelecting previously unselected package pbuilder-satisfydepends-dummy.\n(Reading database ... 17307 files and directories currently installed.)\nPreparing to unpack .../pbuilder-satisfydepends-dummy.deb ...\nUnpacking pbuilder-satisfydepends-dummy (0.invalid.0) ...\ndpkg: dependency problems prevent configuration of pbuilder-satisfydepends-dummy:\n pbuilder-satisfydepends-dummy depends on cdbs; however:\n  Package cdbs is not installed.\n pbuilder-satisfydepends-dummy depends on libaccountsservice-dev (>= 0.6.39); however:\n  Package libaccountsservice-dev is not installed.\n")),Object(r.b)("p",null,"Masuk ke base.tgz ( dengan opsi --save-after-login dan --save-after-exec), lalu pasang paket terkait. Saat logout, perubahan akan tersimpan. Ulangi buildnya."),Object(r.b)("h3",{id:"no-suitable-builder-found"},"No suitable builder found"),Object(r.b)("p",null,"Hal ini disebabkan karena irgsh belum dapat menerima '''linux-any'''. Oleh karena itu, '''linux-any''' diganti menjadi '''any''' ketika terdapat pada '''architecture''' dan dihapus jika terdapat di dependensi paket."),Object(r.b)("h3",{id:"build-gagal-banyak-paket-yang-404-di-buildloggz"},"Build gagal, banyak paket yang 404 di build.log.gz"),Object(r.b)("p",null,"Kondisi paling dekat adalah reprepro sudah menarik index paket namun belum selesai mengunduh keseluruhan paket-paket aslinya."),Object(r.b)("h3",{id:"build-gagal-setelah-langkah-uploading-package-dan-tidak-ada-laporan-dari-repolog"},"Build gagal setelah langkah ",Object(r.b)("inlineCode",{parentName:"h3"},"Uploading package")," dan tidak ada laporan dari repo.log"),Object(r.b)("p",null,"Cek ke user builder, lihat log ",Object(r.b)("inlineCode",{parentName:"p"},"irgsh-uploader"),". Jika ada indikasi kegagalan unggah, ujicoba kembali akses ssh antar user terkait IRGSH satu sama lain melalui konfigurasi SSH bawaan (port 22). Misal dari ",Object(r.b)("inlineCode",{parentName:"p"},"irgsh-builder-ajeng")," ke ",Object(r.b)("inlineCode",{parentName:"p"},"irgsh-repo"),". Pastikan mereka bisa saling mengakses."),Object(r.b)("h1",{id:"sertifikat"},"Sertifikat"),Object(r.b)("p",null,"Sertifikat-sertifikat untuk keperluan irgsh terletak di ",Object(r.b)("inlineCode",{parentName:"p"},"/cert/"),"."))}o.isMDXComponent=!0}}]);